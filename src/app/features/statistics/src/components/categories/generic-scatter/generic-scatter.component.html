<ng-container *ngIf="data$ | async as timeBuckets; else loading">

    <app-correlation-header [categories]="categories" [selectedCategory]="selectedCategory"
        [date]="dateFrom + ' - ' + dateTo" [description]="descriptionCorrelation"
        (categoryClicked)="setChartpoints(timeBuckets, $event, selectedOptionDropdown)">
    </app-correlation-header>

    <div *ngIf="multipleOptions" class="dropdown-container">

        <mat-form-field>

            <mat-select [(value)]="selectedOptionDropdown"
                (selectionChange)="onDropdownChange(timeBuckets, $event.value)">

                <mat-option *ngFor="let option of activeUniqueOptions" [value]="option">
                    {{ option }}
                </mat-option>

            </mat-select>

        </mat-form-field>

    </div>

    <div class="chart-section">

        <div class="center">
            <app-scatter-chart [values1]="chartPointsUser" [values2]="chartPointsCompare" [textX]="textX"
                [textY]="textY">
            </app-scatter-chart>
        </div>

        <div class="center">

            <div class="chart-text">
                <div class="correlation-title">{{ pearsonCorrelationTitle }}</div>

                <div>
                    <span class="primary-color">Korrelation 0:</span> Die 2 Variablen haben keinen Zusammenhang
                </div>

                <div>
                    <span class="primary-color">Korrelation -1:</span> Die 2 Variablen haben einen vollständigen
                    negativen Zusammenhang
                </div>

                <div>
                    <span class="primary-color">Korrelation 1:</span> Die 2 Variablen haben einen vollständigen
                    positiven Zusammenhang
                </div>


                <mat-slider class="cdk-focused" thumbLabel tickInterval="0.1" min="-1" max="1"
                    [value]="pearsonCorrelation"></mat-slider>

                <div class="slider-legend">
                    <div class="slider-color">-1</div>
                    <div class="slider-color center">0</div>
                    <div class="slider-color right">1</div>
                </div>

                <div>{{ pearsonCorrelationExplanation }}</div>

                <div class="hint">Achtung: desto weniger Daten es gibt desto weniger aussagekräftig ist das Ergebnis
                </div>

            </div>

        </div>

    </div>

</ng-container>


<ng-template #loading>

    <app-loading-screen></app-loading-screen>

</ng-template>